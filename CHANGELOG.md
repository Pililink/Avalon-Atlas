# Changelog

本文档记录 Avalon Atlas 的所有重要变更。

格式遵循 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

---

## [1.0.2] - 2025-01-21

### ✨ 新增功能

#### 窗口置顶
- **置顶按钮**：添加窗口置顶功能，支持一键切换置顶状态
- **Windows API 实现**：使用 Windows API (SetWindowPos) 避免 Qt 窗口状态异常
- **配置持久化**：置顶状态自动保存，重启后恢复

#### 地图详细信息复制
- **格式化复制**：双击地图列表项复制完整的格式化信息
- **中文资源名称**：使用统一的中文名称（金洞、蓝洞、绿洞、石点、木点、矿点等）
- **分类显示**：资源信息按类别分组（洞穴 | 资源点 | 箱子），使用 `|` 分隔符

#### 用户界面优化
- **中文类型显示**：地图列表显示中文类型描述（如"通向外界-皇家大陆(蓝/黄区)"）
- **状态消息优化**：移除底部状态栏，在按钮区域内联显示状态消息，节省垂直空间
- **消息位置调整**：状态消息显示在"已选 N 条"标签右侧，同一行显示

### 🔧 修复

- **热键冲突**：使用递增计数器生成唯一热键 ID，避免 hash 冲突
- **启动性能**：延迟初始化 RapidOCR 引擎，避免启动时阻塞
- **截图性能**：复用 mss 截图实例，提升截图性能

### 📝 文档

- **模型注释**：修正模型注释（lowGold 为蓝箱，solo 为绿洞，brecilien 为兔子洞）
- **使用说明**：更新双击复制功能说明，改为"复制详细信息"

### ⚡ 性能优化

- **搜索缓存**：增加搜索缓存容量至 256，优化重复搜索性能
- **搜索算法**：搜索算法增加早期剪枝优化
- **窗口状态**：优化预览窗口层级问题，使用 Tool 窗口类型确保置顶显示

---

## [1.0.1] - 2025-01-20

### 🔧 修复

- **编码问题**：解决 Unicode 编码问题
- **构建脚本**：修复构建脚本，添加应用图标和窗口模式
- **资源路径**：调整资源路径以兼容 PyInstaller

### 📦 发布

- **版本格式**：改进发布工作流，正确格式化 ZIP 文件名
- **错误处理**：改进缺失 artifacts 的错误处理

---

## [1.0.0] - 2025-01-20

### 🎉 首次发布

这是 Avalon Atlas 的第一个正式版本！

### ✨ 新增功能

#### 核心功能
- **智能搜索系统**：子序列模糊匹配算法，支持拼写容错和智能排序
- **双热键 OCR 识别**：
  - 鼠标 OCR：全局热键截图识别地图名称
  - 聊天框 OCR：框选区域批量识别多个地图名
- **地图数据展示**：包含箱子、洞穴、资源、传送门等详细信息
- **实时预览**：鼠标悬停显示地图完整大图

#### 用户界面
- 基于 PySide6 (Qt6) 的现代化界面
- 搜索结果高亮显示匹配字符
- 支持热键录制功能
- 双击复制地图名称

#### 配置管理
- 自动生成默认配置文件 (`config.json`)
- 支持自定义 OCR 引擎和识别区域
- 支持调试模式（保存 OCR 截图）

### 📊 数据
- 包含 400+ 张阿瓦隆地图数据
- 支持地图缩略图和完整大图预览
- 地图等级标注 (T4/T6/T8)

### 🛠️ 技术特性
- **搜索算法**：动态规划评分 + LRU 缓存优化
- **OCR 矫正**：智能修正数字误识别和特殊符号
- **模糊匹配**：支持 difflib 相似度匹配
- **便携版**：解压即用，无需安装

### 📦 打包发布
- Windows 可执行文件（无控制台窗口）
- 便携版 ZIP 压缩包
- 自动构建和验证脚本

### 📚 文档
- 完整的用户使用指南
- 详细的配置说明
- 常见问题解答
- 开发者文档 (CLAUDE.md)

---

## [Unreleased]

### 计划中的功能
- [ ] 应用图标设计
- [ ] 多语言支持（英文/中文切换）
- [ ] 历史搜索记录
- [ ] 收藏夹功能
- [ ] 地图对比功能
- [ ] 自动更新检查

### 待优化
- [ ] OCR 识别准确率提升
- [ ] 搜索结果缓存策略优化
- [ ] UI 响应速度优化

---

## 版本号说明

版本号格式：`主版本号.次版本号.修订号`

- **主版本号**：不兼容的 API 变更
- **次版本号**：向后兼容的功能新增
- **修订号**：向后兼容的问题修复

示例：
- `1.0.0` → `1.0.1`：修复了一个 bug
- `1.0.0` → `1.1.0`：新增了一个功能
- `1.0.0` → `2.0.0`：重大变更，可能不兼容旧版本

---

## 更新类型说明

- **新增 (Added)**: 新功能
- **变更 (Changed)**: 现有功能的变更
- **弃用 (Deprecated)**: 即将移除的功能
- **移除 (Removed)**: 已移除的功能
- **修复 (Fixed)**: 问题修复
- **安全 (Security)**: 安全相关的修复
